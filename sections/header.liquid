<div
  data-animation="default"
  class="navbar1_component w-nav"
  data-easing2="ease"
  fs-scrolldisable-element="smart-nav"
  data-easing="ease"
  data-collapse="medium"
  role="banner"
  data-duration="400"
  x-data="{modals: 0}"
>
  <div class="navbar1_container">
    <a href="{{ shop_locale.root_url }}" li-object:href="shop_locale.root_url" class="navbar1_logo-link w-nav-brand">
      <img src="{{ 'Logo_lowRes.png' | asset_url }}" loading="lazy" alt="" class="navbar1_logo">
    </a>
    <nav role="navigation" class="navbar1_menu w-nav-menu">
      {% for link in linklists['main-menu'].links %}
        <div li-for="link in linklists['main-menu'].links" class="navbar1_link is-container">
          <a
            href="{{ link.url }}"
            li-object:text="link.title"
            li-object:href="link.url"
            class="navbar1_link w-nav-link"
          >
            {{ link.title }}
          </a>
        </div>
      {% endfor %}
    </nav>
    <div class="navbar_shop-icons">
      <div>
        <div x-bind:class="modals === 1 ? 'is-open' : ''" class="navbar_predictive-search-holder">
          <div x-on:click="modals = 0" class="navbar_predictive-search-close"></div>
          {% render 'predictive_search_co' %}
        </div>
      </div>
      {% if customer %}
        <div li-if="customer">
          <a
            li-object:href="routes.account_url"
            href="{{ routes.account_url }}"
            class="navbar_shop-icon w-inline-block"
          >
            <div class="icon-embed-xsmall w-embed">
              <svg
                width="100%"
                height="100%"
                viewbox="0 0 24 24"
                fill="none"
                preserveaspectratio="xMidYMid meet"
                aria-hidden="true"
                role="img"
              >
                    <mask id="mask0_2941_121306" style="mask-type:alpha" maskunits="userSpaceOnUse" x="0" y="0" width="24" height="24">
                    <rect width="24" height="24" fill="#D9D9D9">
                        </rect>
                    </mask>
                <g mask="url(#mask0_2941_121306)">
                    <path d="M12 12C10.9 12 9.95833 11.6083 9.175 10.825C8.39167 10.0417 8 9.1 8 8C8 6.9 8.39167 5.95833 9.175 5.175C9.95833 4.39167 10.9 4 12 4C13.1 4 14.0417 4.39167 14.825 5.175C15.6083 5.95833 16 6.9 16 8C16 9.1 15.6083 10.0417 14.825 10.825C14.0417 11.6083 13.1 12 12 12ZM4 20V17.2C4 16.6333 4.14583 16.1125 4.4375 15.6375C4.72917 15.1625 5.11667 14.8 5.6 14.55C6.63333 14.0333 7.68333 13.6458 8.75 13.3875C9.81667 13.1292 10.9 13 12 13C13.1 13 14.1833 13.1292 15.25 13.3875C16.3167 13.6458 17.3667 14.0333 18.4 14.55C18.8833 14.8 19.2708 15.1625 19.5625 15.6375C19.8542 16.1125 20 16.6333 20 17.2V20H4ZM6 18H18V17.2C18 17.0167 17.9542 16.85 17.8625 16.7C17.7708 16.55 17.65 16.4333 17.5 16.35C16.6 15.9 15.6917 15.5625 14.775 15.3375C13.8583 15.1125 12.9333 15 12 15C11.0667 15 10.1417 15.1125 9.225 15.3375C8.30833 15.5625 7.4 15.9 6.5 16.35C6.35 16.4333 6.22917 16.55 6.1375 16.7C6.04583 16.85 6 17.0167 6 17.2V18ZM12 10C12.55 10 13.0208 9.80417 13.4125 9.4125C13.8042 9.02083 14 8.55 14 8C14 7.45 13.8042 6.97917 13.4125 6.5875C13.0208 6.19583 12.55 6 12 6C11.45 6 10.9792 6.19583 10.5875 6.5875C10.1958 6.97917 10 7.45 10 8C10 8.55 10.1958 9.02083 10.5875 9.4125C10.9792 9.80417 11.45 10 12 10Z" fill="currentColor">
                        </path>
                    </g>
              </svg>
            </div>
          </a>
        </div>
      {% endif -%}
      {%- unless customer %}
        <div li-unless="customer">
          <a
            li-object:href="routes.account_login_url"
            href="{{ routes.account_login_url }}"
            class="navbar_shop-icon w-inline-block"
          >
            <div class="icon-embed-xsmall w-embed">
              <svg
                width="100%"
                height="100%"
                viewbox="0 0 24 24"
                fill="none"
                preserveaspectratio="xMidYMid meet"
                aria-hidden="true"
                role="img"
              >
                    <mask id="mask0_2941_121306" style="mask-type:alpha" maskunits="userSpaceOnUse" x="0" y="0" width="24" height="24">
                    <rect width="24" height="24" fill="#D9D9D9">
                        </rect>
                    </mask>
                <g mask="url(#mask0_2941_121306)">
                    <path d="M12 12C10.9 12 9.95833 11.6083 9.175 10.825C8.39167 10.0417 8 9.1 8 8C8 6.9 8.39167 5.95833 9.175 5.175C9.95833 4.39167 10.9 4 12 4C13.1 4 14.0417 4.39167 14.825 5.175C15.6083 5.95833 16 6.9 16 8C16 9.1 15.6083 10.0417 14.825 10.825C14.0417 11.6083 13.1 12 12 12ZM4 20V17.2C4 16.6333 4.14583 16.1125 4.4375 15.6375C4.72917 15.1625 5.11667 14.8 5.6 14.55C6.63333 14.0333 7.68333 13.6458 8.75 13.3875C9.81667 13.1292 10.9 13 12 13C13.1 13 14.1833 13.1292 15.25 13.3875C16.3167 13.6458 17.3667 14.0333 18.4 14.55C18.8833 14.8 19.2708 15.1625 19.5625 15.6375C19.8542 16.1125 20 16.6333 20 17.2V20H4ZM6 18H18V17.2C18 17.0167 17.9542 16.85 17.8625 16.7C17.7708 16.55 17.65 16.4333 17.5 16.35C16.6 15.9 15.6917 15.5625 14.775 15.3375C13.8583 15.1125 12.9333 15 12 15C11.0667 15 10.1417 15.1125 9.225 15.3375C8.30833 15.5625 7.4 15.9 6.5 16.35C6.35 16.4333 6.22917 16.55 6.1375 16.7C6.04583 16.85 6 17.0167 6 17.2V18ZM12 10C12.55 10 13.0208 9.80417 13.4125 9.4125C13.8042 9.02083 14 8.55 14 8C14 7.45 13.8042 6.97917 13.4125 6.5875C13.0208 6.19583 12.55 6 12 6C11.45 6 10.9792 6.19583 10.5875 6.5875C10.1958 6.97917 10 7.45 10 8C10 8.55 10.1958 9.02083 10.5875 9.4125C10.9792 9.80417 11.45 10 12 10Z" fill="currentColor">
                        </path>
                    </g>
              </svg>
            </div>
          </a>
        </div>
      {% endunless %}
      <script>
    document.addEventListener('alpine:init', () => {

    console.log('handleMinicart init')
    Alpine.data('handleMinicart', () => ({
        open: false,
        note: null,
        attributes: {},
        original_total_price: 0,
        total_price: 0,
        total_discount: 0,
        total_weight: 0.0,
        item_count: 0,
        products: [],
        requires_shipping: false,
        currency: 'EUR',
        items_subtotal_price: 0,
        cart_level_discount_applications: [],
        cartApiResponseDefault : {
            result : {},
            show : false,
            timeout : 5000,
        },
        cartApiResponse : {
            result : {},
            show : false,
            timeout : 5000,
        },

        // deprecated:
        total: {
            items: 0,
            price: 0,
            weight: 0,
            discount: 0,
        },

        toggleMiniCart() {
            this.getCart();
            this.open = !this.open;
        },

        /**
         * Get the cart data.
         */
        getCart() {
            fetch(window.Shopify.routes.root + 'cart.js', {
                method: 'GET',
                headers: {'Content-Type': 'application/json'},
            })
            .then(response => response.json())
            .then(data => {
                console.log('Cart (getCart()): ', data, data.items);

                this.total.items = data.item_count;
                this.products = data.items;
                this.total.price = data.total_price;
                this.total.weight = data.total_weight;
                this.total.discount = data.total_discount;

                this.$dispatch('carttotalitems', data.item_count);
            })
            .catch((error) => {
                console.error('Error:', error);
            });
        },

        /**
         * @param id
         * @param quantity
         */
        increaseCartItemQuantity(id, quantity) {
            this.updateCartItemQuantity(id, parseInt(quantity) + 1);
        },

        /**
         * @param id
         * @param quantity
         */
        decreaseCartItemQuantity(id, quantity) {
            this.updateCartItemQuantity(id, parseInt(quantity) - 1);
        },

        /**
         * Update the cart item.
         *
         * @param id
         * @param quantity
         */
        updateCartItemQuantity(id, quantity) {
            console.log('updateCartItemQuantity(): id, quantity: ', id, quantity);

            fetch(window.Shopify.routes.root + 'cart/change.js', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    id: `${id}`,
                    quantity: quantity,
                }),
            })
                .then(response => response.json())
                .then(data => {
                    console.log('updateCartItemQuantity(): ', data);

                    this.$dispatch('cartupdated');
                    this.$dispatch('showcartmessage', { status: data.status, message: data.message, description: data.description });
                })
                .catch((error) => {
                    console.error('Error:', error);
                    this.$dispatch('showcartmessage', { status: data.status, message: data.message, description: data.description });
                });
        },

        /**
         * Format monetary values.
         * @fixme: This is duplicated in handleVariant.js
         */
        moneyFormat(value, locale = '{{ localization.language.iso_code }}-{{ localization.country.iso_code }}', minor = true) {
            const formatter = new Intl.NumberFormat(locale, {
                style: 'currency',
                currency: '{{ shop.currency }}',
            });

            // @todo: Enable to use more currencies.

            value = minor ? value / 100 : value;

            return formatter.format(value);
        },

        /**
         * Shows the minicart api message
         * @param event
         */
        showCartMessage(event) {
            console.log("dispatched showCartMessage", event)
            if(event?.detail?.status) {
                this.cartApiResponse.result = event.detail ?? this.cartApiResponseDefault.result;
                this.cartApiResponse.show = true
                setTimeout(() =>  this.cartApiResponse =  this.cartApiResponseDefault, this.cartApiResponse.timeout ?? 5000)
            }
        },
    }))
});
      </script>
      <div
        li-element="mini-cart"
        x-cloak=""
        x-data="handleMinicart()"
        x-init="getCart()"
        @cartupdated.window="getCart()"
        @setcartitem.window="updateCartItemQuantity($event.detail.product, $event.detail.quantity)"
        @increasecartitem.window="increaseCartItemQuantity($event.detail.product, $event.detail.quantity)"
        @decreasecartitem.window="decreaseCartItemQuantity($event.detail.product, $event.detail.quantity)"
        @toggleminicart.window="toggleMiniCart()"
        @showcartmessage.window="showCartMessage"
      >
        <div li-element="mini-cart-toggle" class="navbar_shop-icon" @click="$dispatch('toggleminicart')">
          <div class="icon-embed-xsmall w-embed">
            <svg
              width="100%"
              height="100%"
              viewbox="0 0 24 24"
              fill="none"
              preserveaspectratio="xMidYMid meet"
              aria-hidden="true"
              role="img"
            >
                  <mask id="mask0_2941_121294" style="mask-type:alpha" maskunits="userSpaceOnUse" x="0" y="0" width="24" height="24">
                  <rect width="24" height="24" fill="#D9D9D9">
                      </rect>
                  </mask>
              <g mask="url(#mask0_2941_121294)">
                  <path d="M6 22C5.45 22 4.97917 21.8042 4.5875 21.4125C4.19583 21.0208 4 20.55 4 20V8C4 7.45 4.19583 6.97917 4.5875 6.5875C4.97917 6.19583 5.45 6 6 6H8C8 4.9 8.39167 3.95833 9.175 3.175C9.95833 2.39167 10.9 2 12 2C13.1 2 14.0417 2.39167 14.825 3.175C15.6083 3.95833 16 4.9 16 6H18C18.55 6 19.0208 6.19583 19.4125 6.5875C19.8042 6.97917 20 7.45 20 8V20C20 20.55 19.8042 21.0208 19.4125 21.4125C19.0208 21.8042 18.55 22 18 22H6ZM6 20H18V8H16V10C16 10.2833 15.9042 10.5208 15.7125 10.7125C15.5208 10.9042 15.2833 11 15 11C14.7167 11 14.4792 10.9042 14.2875 10.7125C14.0958 10.5208 14 10.2833 14 10V8H10V10C10 10.2833 9.90417 10.5208 9.7125 10.7125C9.52083 10.9042 9.28333 11 9 11C8.71667 11 8.47917 10.9042 8.2875 10.7125C8.09583 10.5208 8 10.2833 8 10V8H6V20ZM10 6H14C14 5.45 13.8042 4.97917 13.4125 4.5875C13.0208 4.19583 12.55 4 12 4C11.45 4 10.9792 4.19583 10.5875 4.5875C10.1958 4.97917 10 5.45 10 6Z" fill="currentColor">
                      </path>
                  </g>
            </svg>
          </div>
          <div
            li-element="mini-cart-item-count"
            class="navbar_shop-quantity"
            x-data="{ items: 0 }"
            x-text="items"
            @carttotalitems.window="items = event.detail"
          >
            1
          </div>
        </div>
        <div
          li-cloak="hide"
          li-element="mini-cart-container"
          class="navbar_mini-cart-holder"
          :class="open || 'mini-cart-closed'"
        >
          <div li-element="mini-cart-toggle" class="navbar_mini-cart-close" @click="$dispatch('toggleminicart')"></div>
          <div class="mini-cart_component">
            <div li-element="mini-cart-full" class="mini-cart_full" :style="total.items < 1 && { display: 'none' }">
              <div class="mini-cart_header">
                <div class="heading-style-h3">Cart</div>
                <div li-element="mini-cart-toggle" class="mini-cart_close w-embed" @click="$dispatch('toggleminicart')">
                  <svg width="15" height="15" viewbox="0 0 15 15" fill="none">
                    <path d="M1.84775 14.178L0.447754 12.778L6.04775 7.17798L0.447754 1.57798L1.84775 0.177979L7.44775 5.77798L13.0478 0.177979L14.4478 1.57798L8.84775 7.17798L14.4478 12.778L13.0478 14.178L7.44775 8.57798L1.84775 14.178Z" fill="currentColor">
                        </path>
                  </svg>
                </div>
              </div>
              <div class="mini-cart_line-item no-scrollbar">
                <ul role="list" class="mini-cart_line-item_list w-list-unstyled">
                  <template x-for="product in products" :key="product.key">
                    <li
                      li-element="mini-cart-item"
                      class="mini-cart_line-item_item"
                      x-init="getCart()"
                      @cartupdated.window="getCart()"
                    >
                      <img
                        src="https://d3e54v103j8qbb.cloudfront.net/plugins/Basic/assets/placeholder.60f9b1840c.svg"
                        loading="lazy"
                        alt=""
                        class="mini-cart_line-item_img"
                        x-bind:src="product.image"
                      >
                      <div class="mini-cart_line-item_product-info">
                        <div
                          li-js-object="product.title"
                          class="text-size-regular text-weight-bold"
                          x-text="product.title"
                        >
                          Product Title
                        </div>
                        <div class="mini-cart_line-item_price">
                          <div li-js-price="product.price" class="text-size-small" x-text="moneyFormat(product.price)">
                            14,99 $
                          </div>
                          <template x-if="product.price < product.original_price">
                            <div li-js-if="product.price < product.original_price">
                              <div
                                li-js-price="product.original_price"
                                class="text-size-small text-style-strikethrough text-style-muted"
                                x-text="moneyFormat(product.original_price)"
                              >
                                14,99 $
                              </div>
                            </div>
                          </template>
                        </div>
                        <div class="mini-cart_line-item_quantity">
                          <a
                            li-element="mini-cart-item-decrease"
                            href="#"
                            class="mini-cart_line-item_quantity-adjust"
                            :productprop="product"
                            @click="$dispatch('decreasecartitem', { product: product.id, quantity: product.quantity, action: 'decrease' })"
                          >
                            -
                          </a>
                          <input
                            class="mini-cart_line-item_quantity-adjust"
                            li-element="mini-cart-item-quantity"
                            value="1"
                            :productprop="product"
                            @blur="$dispatch('setcartitem', { product: product.id, quantity: product.quantity })"
                            x-model="product.quantity"
                          >
                          <a
                            li-element="mini-cart-item-increase"
                            href="#"
                            class="mini-cart_line-item_quantity-adjust"
                            :productprop="product"
                            @click="$dispatch('increasecartitem', { product: product.id, quantity: product.quantity, action: 'increase' })"
                          >
                            +
                          </a>
                        </div>
                        <a
                          li-element="mini-cart-item-remove"
                          href="#"
                          class="text-size-tiny text-color-grey"
                          :productprop="product"
                          @click="$dispatch('setcartitem', { product: product.id, quantity: 0 })"
                        >
                          Remove
                        </a>
                      </div>
                    </li>
                  </template>
                </ul>
              </div>
              <div class="mini-cart_footer">
                <div class="mini-cart_footer_total">
                  <div class="text-size-regular text-weight-bold">Subtotal</div>
                  <div>
                    <div
                      li-js-price="total.price"
                      class="text-size-regular text-weight-bold"
                      x-text="moneyFormat(total.price)"
                    >
                      14,99 $
                    </div>
                    <template x-if="total.price < original_total_price">
                      <div li-js-if="total.price < original_total_price">
                        <div
                          li-js-price="original_total_price"
                          class="text-size-regular text-weight-bold text-style-strikethrough text-style-muted"
                          x-text="moneyFormat(original_total_price)"
                        >
                          14,99 $
                        </div>
                      </div>
                    </template>
                  </div>
                </div>
                <div li-cloak="hide" li-element="mini-cart-api-response" class="mini-cart_footer-message">
                  <div class="mini-cart_footer-message-item">
                    <div class="text-size-regular text-weight-bold">Status</div>
                    <div
                      li-js-object="cartApiResponse?.result?.status"
                      class="text-size-regular text-weight-bold"
                      x-text="cartApiResponse?.result?.status"
                    >
                      14,99 $
                    </div>
                  </div>
                  <div class="mini-cart_footer-message-item">
                    <div class="text-size-regular text-weight-bold">Nachricht</div>
                    <div
                      li-js-object="cartApiResponse?.result?.message"
                      class="text-size-regular text-weight-bold"
                      x-text="cartApiResponse?.result?.message"
                    >
                      14,99 $
                    </div>
                  </div>
                  <div class="mini-cart_footer-message-item">
                    <div class="text-size-regular text-weight-bold">Status</div>
                    <div
                      li-js-object="cartApiResponse?.result?.description"
                      class="text-size-regular text-weight-bold"
                      x-text="cartApiResponse?.result?.description"
                    >
                      14,99 $
                    </div>
                  </div>
                </div>
                <a x-bind:href="'/checkout'" href="#" class="button w-button"> Checkout </a>
                <a li-object:href="routes.cart_url" href="{{ routes.cart_url }}" class="button is-secondary w-button">
                  Cart
                </a>
              </div>
            </div>
            <div li-cloak="hide" li-element="mini-cart-empty" :style="total.items && { display: 'none' }">
              <div class="mini-cart_header">
                <div class="heading-style-h3">Cart</div>
                <div li-mini-cart-toggle="" class="mini-cart_close w-embed" @click="$dispatch('toggleminicart')">
                  <svg width="15" height="15" viewbox="0 0 15 15" fill="none">
                    <path d="M1.84775 14.178L0.447754 12.778L6.04775 7.17798L0.447754 1.57798L1.84775 0.177979L7.44775 5.77798L13.0478 0.177979L14.4478 1.57798L8.84775 7.17798L14.4478 12.778L13.0478 14.178L7.44775 8.57798L1.84775 14.178Z" fill="currentColor">
                        </path>
                  </svg>
                </div>
              </div>
              <div class="mini-cart_empty">
                <div class="text-size-regular">No Products selected</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div data-w-id="8bf6dcc9-2b92-1979-3282-0f752a3c92b6" class="navbar1_menu-button w-nav-button">
      <div class="menu-icon1">
        <div class="menu-icon1_line-top"></div>
        <div class="menu-icon1_line-middle">
          <div class="menu-icon_line-middle-inner"></div>
        </div>
        <div class="menu-icon1_line-bottom"></div>
      </div>
    </div>
  </div>
</div>

{% schema %}
{"tag":"div","name":"header","class":"section_navbar","blocks":[{"name":"Vorschlaege","type":"vorschlaege","settings":[{"type":"url","id":"url_link","label":"Link"},{"type":"text","id":"text_text","label":"Text","default":"Tag"}]}],"settings":[{"id":"collection_bestseller","type":"collection","label":"Bestseller"},{"id":"collection_bestseller_limit","type":"range","label":"Limit: Bestseller","default":6,"min":1,"max":99,"step":1}],"presets":[{"name":"header","category":"Liquify"}]}
{% endschema %}
